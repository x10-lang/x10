<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Distributions</title>
</head>

<body>
 <h2><a name="tth_sEc4">
4</a>&nbsp;&nbsp;Distributions</h2><a name="XtenDistributions">
</a>


<div class="p"><!----></div>
Distributed arrays are spread across multiple <b>Place</b>s.  
A <em>distribution</em>, a mapping from a region to a set of places, 
describes where each element of a distributed array is kept.
Distributions are embodied by the class <b>x10.array.Dist</b>.
This class is <b>final</b> in
X10 v2.1; future versions of the language may permit
user-definable distributions. 
The <em>rank</em> of a distribution is the rank of the underlying region, and
thus the rank of every point that the distribution applies to.

<div class="p"><!----></div>
<pre>
val R  &lt;: Region = 1..100;
val D1 &lt;: Dist = Dist.makeBlock(R);
val D2 &lt;: Dist = R -&#62; here;
</pre>

<div class="p"><!----></div>
Let <b>D</b> be a distribution. 
<b>D.region</b> 
denotes the underlying
region. 
Given a point <b>p</b>, the expression
<b>D(p)</b> represents the application of <b>D</b> to <b>p</b>, that is,
the place that <b>p</b> is mapped to by <b>D</b>. The evaluation of the
expression <b>D(p)</b> throws an <b>ArrayIndexOutofBoundsException</b>
if <b>p</b> does not lie in the underlying region.

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.1">
4.1</a>&nbsp;&nbsp;<tt>PlaceGroup</tt>s</h3>

<div class="p"><!----></div>
A <b>PlaceGroup</b> represents an ordered set of <b>Place</b>s.
<b>PlaceGroup</b>s exist for performance and scaleability: they are more
efficient, in certain critical places, than general collections of
<b>Place</b>. <b>PlaceGroup</b> implements <b>Sequence[Place]</b>, and thus
provides familiar operations - <b>pg.size()</b> for the number of places,
<b>pg.iterator()</b> to iterate over them, etc.  

<div class="p"><!----></div>
<b>PlaceGroup</b> is an abstract class.  The concrete class
<b>SparsePlaceGroup</b> is intended for a small group of places: 
in particular, 
<b>new SparsePlaceGroup(somePlace)</b> is a good <b>PlaceGroup</b> containing
one place.  
<b>new SparsePlaceGroup(seqPlaces)</b>
constructs a sparse place group from a sorted sequence of places.

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.2">
4.2</a>&nbsp;&nbsp;Operations returning distributions</h3>


<div class="p"><!----></div>
Let <b>R</b> be a region, <b>Q</b> 
a <b>PlaceGroup</b>, and <b>P</b> a place.

<div class="p"><!----></div>

<b>Unique distribution&nbsp;&nbsp;</b> 
The distribution <b>Dist.makeUnique(Q)</b> is the unique distribution from the
region <b>1..k</b> to <b>Q</b> mapping each point <b>i</b> to <b>pi</b>.

<div class="p"><!----></div>

<b>Constant distributions.&nbsp;&nbsp;</b> 
The distribution <b>R-&#62;P</b> maps every point in region <b>R</b> to place <b>P</b>, as does
<b>Dist.makeConstant(R,P)</b>. 

<div class="p"><!----></div>

<b>Block distributions.&nbsp;&nbsp;</b>
The distribution <b>Dist.makeBlock(R)</b> distributes the elements of <b>R</b>,
in order, over all the places available to the program. 
Let p equal <b></td><td width="150">
&#124;R</td><td width="150">
&#124; div N</b> and q equal <b></td><td width="150">
&#124;R</td><td width="150">
&#124; mod N</b>,
where <b>N</b> is the size of <b>Q</b>, and 
<b></td><td width="150">
&#124;R</td><td width="150">
&#124;</b> is the size of <b>R</b>.  The first q places get
successive blocks of size (p+1) and the remaining places get blocks of
size p.

<div class="p"><!----></div>
There are other <b>Dist.makeBlock</b> methods capable of controlling the
distribution and the set of places used; see the API documentation.

<div class="p"><!----></div>

<div class="p"><!----></div>
<b>Domain Restriction.&nbsp;&nbsp;</b> 

<div class="p"><!----></div>
If <b>D</b> is a distribution and <b>R</b> is a sub-region of <tt>
D.region</tt>, then <b>D </td><td width="150">
&#124; R</b> represents the restriction of <b>D</b> to
<b>R</b>-that is, the distribution that takes each point <b>p</b> in <b>R</b>
to 
<b>D(p)</b>, 
but doesn't apply to any points but those in <b>R</b>.

<div class="p"><!----></div>

<b>Range Restriction.&nbsp;&nbsp;</b>

<div class="p"><!----></div>
If <b>D</b> is a distribution and <b>P</b> a place expression, the term
<b>D </td><td width="150">
&#124; P</b> 
denotes the sub-distribution of <b>D</b> defined over all the
points in the region of <b>D</b> mapped to <b>P</b>.

<div class="p"><!----></div>
Note that <b>D </td><td width="150">
&#124; here</b> does not necessarily contain adjacent points
in <b>D.region</b>. For instance, if <b>D</b> is a cyclic distribution,
<b>D </td><td width="150">
&#124; here</b> will typically contain points that differ by the number of
places. 
An implementation may find a
way to still represent them in contiguous memory, <em>e.g.</em>, using a
complex arithmetic function to map from the region index to an index
into the array.

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>
<pre>
</pre>

<div class="p"><!----></div>

</body>
</html>