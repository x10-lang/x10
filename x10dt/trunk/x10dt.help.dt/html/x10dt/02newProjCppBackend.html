<html>
<head>
<title>X10 project with C++ backend</title>
<link rel="stylesheet" type="text/css" href="style/help.css">
</head>

<body>
<a href="contents.html">Back to Table of Contents</a>

<h1>X10 Project with C++ Back-End</h1>

<p>This section describes how to create and validate an X10 project for generating C++ files as opposed to Java. 
<br>With this back-end, 
the generation of files, compilation and execution can be either be local or remote.</p>

<p>This section first describes how to create and validate a <i>local</i> X10 project with the C++ back-end. 
<br>See <a href="02newProjCppBackendRemote.html">X10 Remote Project with C++ Back-End</a> for the basics on setting up a remote project.

<ul>
<li><a href="#create">Project Creation</a></li>
<li><a href="#config">Project Configuration in Local Mode</a></li>
<li><a href="#validate">Validating Platform Configuration</a></li>
<li><a href="#save">Saving Platform Configuration</a></li>
<li><a href="#launch">Launching</li>
</ul>

<h3 id="create">Project Creation</h3>
<a name="creation"></a>

<p>Once you have Eclipse and X10DT installed, you should be able to create X10 projects through the traditional project
creation wizard dialog: <span class="menu">File &gt; New &gt; Project...</span>
Then you should be able to select an X10 project with C++ back-end as shown below.</p>

<img src="images/cpp-back-end/newCppProjectDialog.png" border="0" />

<p class="note">Alternatively, if you have activated the X10 Perspective <span class="menu">Window &gt Open Perspective 
&gt X10</span>, you should be able to access the next menu items sequence 
<span class="menu">File &gt; New &gt; X10 Project (C++ back-end)</span>, or by doing a right-click in the Package Explorer 
view and selecting <span class="menu">New &gt; X10 Project (C++ back-end)</span>.</p>

The next dialog page will come up:

<img src="images/cpp-back-end/new-proj-name.png" border="0" />

<p>Enter a project name and after that you should be able to click on <span class="menu">Finish</span>, 
or <span class="menu">Next</span> if you want further customizations. For instance, let's call the project <code>demo</code>.</p>

<p>At that point, an X10 project named <code>demo</code>, with C++ back-end  in <b>local mode</b>, with default 
communication interface and compilation commands, should be created. 
The project should now contain the files shown here:
</p>

<img src="images/cpp-back-end/proj-creation-result.png" border="0" />

<p class="note">You can check that the generation of C++ files occurred correctly by checking the content of the project 
output folder. One way to check that is to go to the Eclipse <b>Navigator</b> view, and click under the project folder.
In the case of the <code>demo</code> project, this should give the next list of files.
<img src="images/cpp-back-end/generated-files.png" border="0" />
Note that a <b>refresh</b> on the output folder  directory (named 'bin' here) may be necessary.
To refresh a project or folder/directory, right-click and select 'Refresh'.
</p>

<h3 id="config">Project Configuration in Local Mode</h3>
<a name="local-mode"></a>

<p>Each X10 project with C++ nature has a file named <b>x10_platform.conf</b>. If you double-click on it, a dedicated editor 
should come up in order to customize the default values determined according to your current environment. Here what 
an end-user should see by default on Windows with Cygwin installed.</p>


<p>The new project wizard provides default values for a local project.  These values are complete.
So, nothing on the following dialogs needs to be changed for a minimal local project to work.
The project has default defined values allowing a proper generation of the C++ files for the <code>Hello.x10</code> file
present in the <code>demo</code> project. 

<img src="images/cpp-back-end/local-conf.png" border="0" width="100%"/>


<p>Note that there are two different <i>tabs</i> on this page, indicated at the bottom of the view.
<br><img src="images/platformConfigTabs.png"></br>
The two tabs allow access to two different <i>pages</i> of platform configuration information.
<ul>
<li>Connection and Communication Interface</li>
<li>C++ Compilation and Linking</li>
</ul>
<p>This file contains several major sections that allow the configuration and customization of the C++ files' 
compilation and running generated by the X10 compiler.
</p>
<h3>Page 1: Connection and Communication Interface</h3>
<p>On the Connection and Communication Interface page, the following items can be configured:
</p>
<ol>
<li>There is the <b>Connection</b> section on the first page that defines where the C++ files will be generated and run. 
This is where the local versus remote configuration occurs.

For information on setting up a remote connection, see <a href="02remoteCppProject.html">Setting up a remote X10 C++ backend project</a>.

For this example, assume a local connection: the X10 application will be built and run on the local machine.
Nothing needs to be changed in this section.
<img src="images/cpp-back-end/connection-section.png" border="0" />
</li>
<li>There is the <b>Communication Interface</b> section that defines the interface for interprocess communication.
The default selection will probably be satisfactory (MPICH2 or OpenMPI, depending on your platform).
<img src="images/cpp-back-end/comm-interface-section.png" border="0" />
</li>
</ol>
<h3>Page 2: C++ Compilation and Linking</h3>
<p>On the C++ Compilation and Linking page, the following items can be configured:
<ol>
<li>There is the <b>Compilation and Linking</b> section that defines how to compile the C++ generated files on the target 
machine (which is either local or remote).  For this example we assume a local machine.  Default selections
should match your local machine.
<img src="images/cpp-back-end/comp-link-section.png" border="0" />
</li>
<li>There is the <b>Remote Output Folder</b> section that is only enabled in case of a remote connection and that defines
where the generated files will be transfered on the remote machine.
<img src="images/cpp-back-end/output-folder-section.png" border="0" />
</li>
<li>Finally, there is the <b>X10 Distribution</b> section that is only enabled in case of a remote connection and that 
identifies where the X10 (and potentially PGAS) distribution(s) reside(s) on the remote machine.
<img src="images/cpp-back-end/distribution-section.png" border="0" />
</li>
</ol>
</p>
At this point, for the demo project created by the new project wizard, you could simply go directly to <a href="#launching">launching</a>.
However, we recommend going through the validation process as follows.
</p>


<h3 id="validate">Validating Platform Configuration</h3>

<p>Note that there are two buttons in the upper right corner of the platform configuration form.
<img src="images/platformConfigButtons.png"></img>
</p>
<ul>
<li>The Save button (floppy disk image) is enabled when the configuration information needs to be saved.</li>
<li>The Validate button (green check mark image) starts the validation.</li>
</ul>
It is <i>highly</i> recommended
to try <b>validating the platform configuration</b> when a new configuration is created or when changes are made (unless you are sure the information are valid).
<p>To validate, push the green validate button.</p>

<table border="0">
<tr align="center">
<td><img src="images/cpp-back-end/validation-bt.png" border="0" /></td>
<td><img src="images/cpp-back-end/right_arrow.png" border="0" height="50px"/></td>
<td><img src="images/cpp-back-end/validate-progress-dialog.png" border="0" /></td>
</tr>
</table>

Such action will:
<ol>
<li>Check that a connection is accessible and valid to the target machine</li>
<li>Generate, compile and link on the target machine a simple X10 program.</li>
<li>Try running the Communication Interface Discover command.</li>
</ol>

If the different validations succeed then the <i>push</i> button should be changed into a happy smiley like below.

<img src="images/cpp-back-end/validation-success.png" border="0" />

In case of a failure, a sad smiley with a dialog box giving some explanation should come up.

<img src="images/cpp-back-end/validation-failure.png" border="1" />

<p class="note">A third smiley can also be seen when an internal error occurs during the validation process. This is
a sick smiley and, as for the failure, a dialog box should provide information about the exception, assertion or other event
that created the pathological issue.

<img src="images/cpp-back-end/validation-error.png" border="0" />
<br/>
In such case, it is recommended to report the problem to X10DT team by submitting a bug report to 
<a href="http://jira.codehaus.org/browse/XTENLANG">X10 JIRA</a>.
</p>

<h3 id="save">Saving Platform Configuration</h3>
<a name="saving"></a>

As soon as some changes to the current configuration are made, the form becomes <i>dirty</i> and the <i>Save</i> button
becomes enabled.

<img src="images/cpp-back-end/save-platform-bt.png" border="0" />

<p>Clicking on it will save the form but also will:
<ul>
<li>Check the remote connection information if needed.</li>
<li>Check the communication interface discover command.</li>
<li>Trigger the X10 builder to build the X10 project.</li>
</ul>
</p>

<p>Any error with one of these actions will create an error marker on the platform configuration file for the relevant project.
They may be shown in more than one place, including the problems view as shown here:
<!--  BRT ask Emmanuel: are they shown in the problems view now? I don't see it. -->
</p>

<img src="images/cpp-back-end/platform-conf-marker.png" border="0" />

<p>Errors may also be indicated by the "XX errors detected" red text at the top of the X10 Platform Configuration form.
Hover over the "errors detected" message for more information.
<img src="images/cpp-back-end/error-config-hover.png"></img></p>
<p>
Note that the error could be on the <i>other</i> of the two pages of the platform configuration form.
The error should be indicated on the form with a small red X icon.
<img src="images/cpp-back-end/error-config-field.png"></img></p>
</p>
</p>

<p>&nbsp;
<p>Continue to <a href="04runCppBackend.html">Running/Launching an X10 Application with the C++ back-end</a></p>
<p>&nbsp;
<p><a href="contents.html">Back to X10DT Table of Contents</a></p>
</body>
</html>