<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Operations on arrays</title>
</head>

<body>
 <h2><a name="tth_sEc5">
5</a>&nbsp;&nbsp;Operations on arrays</h2>
In the following let <b>a</b> be an array with distribution <b>D</b> and
base type <b>T</b>. 

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.1">
5.1</a>&nbsp;&nbsp;Element operations</h3>
The value of <b>a</b> at a point <b>p</b> in its region of definition is
obtained by using the indexing operation <b>a(p)</b>. This operation
may be used on the left hand side of an assignment operation to update
the value. The operator assignments <b>a(i) op= e</b> are also available
in X10.

<div class="p"><!----></div>
For array variables, the right-hand-side of an assignment must
have the same distribution <b>D</b> as an array being assigned. This
assignment involves
control communication between the sites hosting <b>D</b>. Each
site performs the assignment(s) of array components locally. The
assignment terminates when assignment has terminated at all
sites hosting <b>D</b>.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.2">
5.2</a>&nbsp;&nbsp;Constant promotion</h3><a name="ConstantArray">
</a>

<div class="p"><!----></div>
For a distribution <b>D</b> and a val <b>v</b> of
type <b>T</b> the expression <b>new Array[T](D, (p: Point) =&#62; v)</b>
denotes the mutable array with
distribution <b>D</b> and base type <b>T</b> initialized with <b>v</b>
at every point.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.3">
5.3</a>&nbsp;&nbsp;Restriction of an array</h3>

<div class="p"><!----></div>
Let <b>D1</b> be a sub-distribution of <b>D</b>. Then <b>a </td><td width="150">
&#124; D1</b>
represents the sub-array of <b>a</b> with the distribution <b>D1</b>.

<div class="p"><!----></div>
Recall that a rich set of operators are available on distributions
(&#167;<a href="#XtenDistributions">3</a>) to obtain sub-distributions
(e.g. restricting to a sub-region, to a specific place etc).

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.4">
5.4</a>&nbsp;&nbsp;Assembling an array</h3>
Let <b>a1,a2</b> be arrays of the same base type <b>T</b> defined over
distributions <b>D1</b> and <b>D2</b> respectively. Assume that both
arrays are value or reference arrays. 

<div class="p"><!----></div>
<b>Assembling arrays over disjoint regions&nbsp;&nbsp;</b>

<div class="p"><!----></div>
If <b>D1</b> and <b>D2</b> are disjoint then the expression <b>a1 </td><td width="150">
&#124;</td><td width="150">
&#124; a2</b> denotes the unique array of base type <b>T</b> defined over the
distribution <b>D1 </td><td width="150">
&#124;</td><td width="150">
&#124; D2</b> such that its value at point <b>p</b> is
<b>a1(p)</b> if <b>p</b> lies in <b>D1</b> and <b>a2(p)</b>
otherwise. This array is a reference (value) array if <b>a1</b> is.

<div class="p"><!----></div>

<b>Overlaying an array on another&nbsp;&nbsp;</b>
The expression
<b>a1.overlay(a2)</b> (read: the array <b>a1</b> <em>overlaid with</em> <b>a2</b>)
represents an array whose underlying region is the union of that of
<b>a1</b> and <b>a2</b> and whose distribution maps each point <b>p</b>
in this region to <b>D2(p)</b> if that is defined and to <b>D1(p)</b>
otherwise. The value <b>a1.overlay(a2)(p)</b> is <b>a2(p)</b> if it is defined and <b>a1(p)</b> otherwise.

<div class="p"><!----></div>
This array is a reference (value) array if <b>a1</b> is.

<div class="p"><!----></div>
The expression <b>a1.update(a2)</b> updates the array <b>a1</b> in place
with the result of <b>a1.overlay(a2)</b>.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.5">
5.5</a>&nbsp;&nbsp;Global operations </h3>

<div class="p"><!----></div>

<b>Pointwise operations&nbsp;&nbsp;</b><a name="ArrayPointwise">
</a>
The unary <b>lift</b> operation applies a function to each element of
an array, returning a new array with the same distribution.
The <b>lift</b> operation is implemented by the following method
in <b>Array[T]</b>:
<pre>
def lift[S](f: (T) =&#62; S): Array[S](dist);
</pre>

<div class="p"><!----></div>
The binary <b>lift</b> operation takes a binary function and
another
array over the same distribution and applies the function
pointwise to corresponding elements of the two arrays, returning
a new array with the same distribution.
The <b>lift</b> operation is implemented by the following method
in <b>Array[T]</b>:
<pre>
def lift[S,R](f: (T,S) =&#62; R, Array[S](dist)): Array[R](dist);
</pre>

<div class="p"><!----></div>

<b>Reductions&nbsp;&nbsp;</b><a name="ArrayReductions">
</a>

<div class="p"><!----></div>
Let <b>f</b> be a function of type <b>(T,T)=&#62;T</b>.  Let
<b>a</b> be a value or reference array over base type <b>T</b>.
Let <b>unit</b> be a value of type <b>T</b>.
Then the
operation <b>a.reduce(f, unit)</b> returns a value of type <b>T</b> obtained
by performing <b>f</b> on all points in <b>a</b> in some order, and in
parallel.  The function <b>f</b> must be associative and
commutative.  The value <b>unit</b> should satisfy
<b>f(unit,x)</b> <b>==</b> <b>x</b> <b>==</b> <b>f(x,unit)</b>.

<div class="p"><!----></div>
This operation involves communication between the places over which
the array is distributed. The X10 implementation guarantees that
only one value of type <b>T</b> is communicated from a place as part of
this reduction process.

<div class="p"><!----></div>

<b>Scans&nbsp;&nbsp;</b><a name="ArrayScans">
</a>

<div class="p"><!----></div>
Let <b>f</b> be a reduction operator defined on type <b>T</b>. Let
<b>a</b> be a value or reference array over base type <b>T</b> and
distribution <b>D</b>. Then the operation <b>a</td><td width="150">
&#124;</td><td width="150">
&#124;f()</b> returns an array
of base type <b>T</b> and distribution <b>D</b> whose ith element
(in canonical order) is obtained by performing the reduction <b>f</b>
on the first i elements of <b>a</b> (in canonical order).

<div class="p"><!----></div>
This operation involves communication between the places over which
the array is distributed. The X10 implementation will endeavour to
minimize the communication between places to implement this operation.

<div class="p"><!----></div>
Other operations on arrays may be found in <b>x10.lang.Array</b> and
other related classes.

</body>
</html>