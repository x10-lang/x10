<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="GENERATOR" content="TtH 3.80">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
	<title>Futures</title>
</head>

<body>
 <h2><a name="tth_sEc8">
8</a>&nbsp;&nbsp;Futures</h2><a name="XtenFutures">
</a>

<div class="p"><!----></div>
X10 provides syntactic support for <em>asynchronous expressions</em>, also
known as futures.  Futures let you start a subcomputation that will return a
value, and let it proceed asynchronously.  When you need its value, apply
<b>force()</b> to the future, which will wait until that computation is done
(if necessary).  Then, calling the future as a nullary function retrieves the
value of the computation.
<pre>
    val future_a = future &#235;xpression that takes a long time";
    val b = "Some long computation happens here";
    future_a.force();
    val a = future_a(); // get its value
</pre>

<div class="p"><!----></div>
  :  |        <em>  
<table>
<tr><td align="right">Primary ::= FutureExpression </td></tr>
<tr><td align="right">FutureExpression ::=
  <b>future</b> PlaceExpressionSingleList<sup>?</sup>&nbsp;ClosureBody
</td></tr></table>
</em> 

<div class="p"><!----></div>
In more detail, in an expression <b>future (Q) e</b>, the place
expression <b>Q</b> is treated as in an <b>async</b> statement. <b>e</b>
is an expression of some type <b>T</b>. <b>e</b> may reference only
those variables in the enclosing lexical environment which are
declared to be <b>val</b>.

<div class="p"><!----></div>
If the type of <b>e</b> is <b>T</b> then the type of
<b>future (Q) e</b> is <b>Future[T]</b>.  This 
type <b>Future[T]</b> is defined as if by:
<pre>
package x10.lang;
public interface Future[T] implements () =&#62; T {
  public def apply(): T;
  global def forced(): Boolean;
  global def force(): T;
}
</pre>

<div class="p"><!----></div>
Evaluation of <b>future (Q) e</b> terminates locally with the creation
of a value <b>f</b> of type <b>Future[T]</b>.  This value may be
stored in objects, passed as arguments to methods, returned from
method invocation etc. 

<div class="p"><!----></div>
At any point, the method <b>forced</b> may be invoked on <b>f</b>. This
method returns without blocking, with the value <b>true</b> if the
asynchronous evaluation of <b>e</b> has terminated globally and with
the value <b>false</b> if it has not.

<div class="p"><!----></div>
<b>Future[T]</b> is a subtype of the function type <b>() =&#62; T</b>.
Invoking-<em>forcing</em>-the future <b>f</b> blocks until the
asynchronous evaluation of <b>e</b> has terminated globally. If the
evaluation terminates successfully with value <b>v</b>, then the method
invocation returns <b>v</b>. If the evaluation terminates abruptly with
exception <b>z</b>, then the method throws exception <b>z</b>. Multiple
invocations of the function (by this or any other activity) do not
result in multiple evaluations of <b>e</b>. The results of the first
evaluation are stored in the future <b>f</b> and used to respond to all
queries.

<div class="p"><!----></div>

</body>
</html>